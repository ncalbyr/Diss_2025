<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Appendix: Code Guide | Report</title>
  <meta name="description" content="Chapter 5 Appendix: Code Guide | Report" />
  <meta name="generator" content="bookdown 0.34 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Appendix: Code Guide | Report" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Appendix: Code Guide | Report" />
  
  
  

<meta name="author" content="Jiayi and Louise" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="real-data.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.10.2/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.28/datatables.js"></script>
<link href="libs/dt-core-1.13.4/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.4/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.4/js/jquery.dataTables.min.js"></script>
<link href="libs/dt-ext-fixedcolumns-1.13.4/css/fixedColumns.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-fixedcolumns-1.13.4/js/dataTables.fixedColumns.min.js"></script>
<link href="libs/dt-ext-fixedheader-1.13.4/css/fixedHeader.dataTables.min.css" rel="stylesheet" />
<script src="libs/dt-ext-fixedheader-1.13.4/js/dataTables.fixedHeader.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="cross.html"><a href="cross.html"><i class="fa fa-check"></i><b>2</b> Methods</a>
<ul>
<li class="chapter" data-level="2.1" data-path="cross.html"><a href="cross.html#mark-recapture"><i class="fa fa-check"></i><b>2.1</b> Mark-Recapture</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="cross.html"><a href="cross.html#closed-populations"><i class="fa fa-check"></i><b>2.1.1</b> Closed populations</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="cross.html"><a href="cross.html#distance-sampling"><i class="fa fa-check"></i><b>2.2</b> Distance Sampling</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="cross.html"><a href="cross.html#line-transect-sampling"><i class="fa fa-check"></i><b>2.2.1</b> Line transect sampling</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="cross.html"><a href="cross.html#mrds"><i class="fa fa-check"></i><b>2.3</b> MRDS</a></li>
<li class="chapter" data-level="2.4" data-path="cross.html"><a href="cross.html#d-distance"><i class="fa fa-check"></i><b>2.4</b> 2D Distance</a></li>
<li class="chapter" data-level="2.5" data-path="cross.html"><a href="cross.html#further-reading"><i class="fa fa-check"></i><b>2.5</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="simulation.html"><a href="simulation.html"><i class="fa fa-check"></i><b>3</b> Simulation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="simulation.html"><a href="simulation.html#simulation-scenarios"><i class="fa fa-check"></i><b>3.1</b> Simulation scenarios</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="simulation.html"><a href="simulation.html#initial-perpendicular-distance-distribution"><i class="fa fa-check"></i><b>3.1.1</b> Initial perpendicular distance distribution</a></li>
<li class="chapter" data-level="3.1.2" data-path="simulation.html"><a href="simulation.html#movement-after-first-detection"><i class="fa fa-check"></i><b>3.1.2</b> Movement after first detection</a></li>
<li class="chapter" data-level="3.1.3" data-path="simulation.html"><a href="simulation.html#imperfect-matching"><i class="fa fa-check"></i><b>3.1.3</b> Imperfect Matching</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="simulation.html"><a href="simulation.html#simulation-results"><i class="fa fa-check"></i><b>3.2</b> Simulation Results</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="simulation.html"><a href="simulation.html#uniform-animal-distribution"><i class="fa fa-check"></i><b>3.2.1</b> Uniform Animal Distribution</a></li>
<li class="chapter" data-level="3.2.2" data-path="simulation.html"><a href="simulation.html#avoiding-transect"><i class="fa fa-check"></i><b>3.2.2</b> Avoiding Transect</a></li>
<li class="chapter" data-level="3.2.3" data-path="simulation.html"><a href="simulation.html#attracted-to-transect"><i class="fa fa-check"></i><b>3.2.3</b> Attracted to Transect</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="simulation.html"><a href="simulation.html#conclusions"><i class="fa fa-check"></i><b>3.3</b> Conclusions</a></li>
<li class="chapter" data-level="3.4" data-path="simulation.html"><a href="simulation.html#further-reading-1"><i class="fa fa-check"></i><b>3.4</b> Further Reading</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="real-data.html"><a href="real-data.html"><i class="fa fa-check"></i><b>4</b> Real Data</a>
<ul>
<li class="chapter" data-level="4.1" data-path="real-data.html"><a href="real-data.html#mark-recapture-1"><i class="fa fa-check"></i><b>4.1</b> Mark Recapture</a></li>
<li class="chapter" data-level="4.2" data-path="real-data.html"><a href="real-data.html#conventional-distance-sampling"><i class="fa fa-check"></i><b>4.2</b> Conventional Distance Sampling</a></li>
<li class="chapter" data-level="4.3" data-path="real-data.html"><a href="real-data.html#d-distance-sampling"><i class="fa fa-check"></i><b>4.3</b> 2D Distance Sampling</a></li>
<li class="chapter" data-level="4.4" data-path="real-data.html"><a href="real-data.html#summary"><i class="fa fa-check"></i><b>4.4</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="appendix-code-guide.html"><a href="appendix-code-guide.html"><i class="fa fa-check"></i><b>5</b> Appendix: Code Guide</a>
<ul>
<li class="chapter" data-level="5.1" data-path="appendix-code-guide.html"><a href="appendix-code-guide.html#summary-1"><i class="fa fa-check"></i><b>5.1</b> Summary</a></li>
<li class="chapter" data-level="5.2" data-path="simulation.html"><a href="simulation.html#simulation"><i class="fa fa-check"></i><b>5.2</b> Simulation</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="appendix-code-guide.html"><a href="appendix-code-guide.html#sim.data"><i class="fa fa-check"></i><b>5.2.1</b> Simulating the Data using sim.data</a></li>
<li class="chapter" data-level="5.2.2" data-path="appendix-code-guide.html"><a href="appendix-code-guide.html#sim.mismatch"><i class="fa fa-check"></i><b>5.2.2</b> Imperfect Matching</a></li>
<li class="chapter" data-level="5.2.3" data-path="appendix-code-guide.html"><a href="appendix-code-guide.html#result"><i class="fa fa-check"></i><b>5.2.3</b> Getting the results</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Report</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="appendix-code-guide" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Appendix: Code Guide<a href="appendix-code-guide.html#appendix-code-guide" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="summary-1" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Summary<a href="appendix-code-guide.html#summary-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><a href="simulation.html#simulation"><code>simulation(n,b,density,movement,mismatch)</code></a> - generates b estimates of abundance with confidence intervals for each of the 4 methods for a scenario with <code>n</code> total animals</li>
<li><code>result(list.method, n)</code> calculates the bias and coverage probability for each method from the output of <code>simulation</code> , given the true abundance is <code>n</code> .</li>
<li><a href="appendix-code-guide.html#sim.data"><code>sim.data(n,density,move)</code></a> generates detections from a population of n animals with specified density and movement. Change this function if you want a different detection function or different parameters for density or movement. (you will need to update fit.2d if you change the density parameters)</li>
<li><a href="appendix-code-guide.html#sim.mismatch"><code>sim.mismatch(df)</code></a> simulates imperfect matching on a sim.data data frame. Change this function if you want different matching parameters</li>
<li><code>chapman.mr(df,mismatch)</code> uses the chapman estimator on a sim.data data frame to get an abundance estimate and confidence interval. If <code>mismatch = TRUE</code> it runs <code>mismatch</code> on the data first.</li>
<li><code>ds.analysis(df)</code> fits a hazard rate detection function to a sim.data data frame to get an abundance estimate and confidence interval.</li>
<li><code>fit.mrds(df, mismatch)</code> uses an independent observer configuration and a hazard rate detection function to get an abundance estimate and confidence interval from a sim.data data frame. If <code>mismatch = TRUE</code> it runs <code>mismatch</code> on the data first.</li>
<li><code>fit.2d(df, density)</code> fits a 2D model to a sim.data data frame using same density function as used to generate data. Returns a point estimate and confidence interval for abundance. If you change the density parameters in sim.data make sure to update them in fit.2d.</li>
</ul>
<p>All of our functions use the following inputs:</p>
<ul>
<li><p>n - True Animal Abundance</p></li>
<li><p>b - Number of Repetitions</p></li>
<li><p>density - 0 for uniform distribution, 1 for avoidance, 2 for attraction</p></li>
<li><p>movement - 0 for avoidance, 1 for random</p></li>
<li><p>mismatch - FALSE for perfect matching, TRUE for imperfect matching</p></li>
<li><p>df - the output from <a href="simulation.html#simulation"><code>simulation(n,b,density,movement,mismatch)</code></a> function</p></li>
</ul>
</div>
<div id="simulation" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Simulation<a href="simulation.html#simulation" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The <code>simulation(n,b,density, movement, mismatch)</code> function is the main function used to simulate the data. It returns a list of data frames of the estimates for N and the lower and upper confidence limits for each of the 4 methods (MR, DS, MRDS, 2DDS).</p>
<p>The output from <code>simulation</code> can be parsed to <code>result(list.method,n)</code> , which returns the bias and coverage probability given that the true abundance is <code>n</code>.</p>
<div id="sim.data" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Simulating the Data using sim.data<a href="appendix-code-guide.html#sim.data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>simulation</code> starts by calling the <code>sim.data(n,density,move)</code> function to generate <code>b</code> datasets. <code>sim.data</code> returns a data frame of all the seen animals. Each animal has 2 rows, one for each capture occasion. The “x” and “y” columns are the co-ordinates of each animal on each capture occasion, “forw.dist” is the forward distance to detection (only generated for the first occasion) and “detect” is 1 if the animal was detected on that capture occasion and 0 otherwise. Perpendicular distance can be found from the absolute value of x.</p>
<div id="initial-positions" class="section level4 hasAnchor" number="5.2.1.1">
<h4><span class="header-section-number">5.2.1.1</span> Initial Positions<a href="appendix-code-guide.html#initial-positions" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><code>sim.data</code> generates the initial animal positions within 2000m either side of a 600km transect using the simpop2DLT function.</p>
<p><strong>Note:</strong> we later truncate perpendicular distances at 1600m but the actual area still has a half-width of 2000m, and confusing this caused us some issues. The area is larger than the perpendicular truncation distance to prevent issues with animals moving outside the boundary.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="appendix-code-guide.html#cb2-1" tabindex="-1"></a><span class="co"># (a) initial animal distribution</span></span>
<span id="cb2-2"><a href="appendix-code-guide.html#cb2-2" tabindex="-1"></a><span class="cf">if</span>(density<span class="sc">==</span><span class="dv">0</span>){pi.fun.name <span class="ot">&lt;-</span> <span class="st">&#39;pi.const&#39;</span>; logphi <span class="ot">&lt;-</span> <span class="cn">NA</span>}  <span class="co"># uniform</span></span>
<span id="cb2-3"><a href="appendix-code-guide.html#cb2-3" tabindex="-1"></a><span class="cf">else</span> <span class="cf">if</span>(density<span class="sc">==</span><span class="dv">1</span>){pi.fun.name <span class="ot">&lt;-</span> <span class="st">&#39;pi.chnorm&#39;</span>; logphi <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">6</span>)}  <span class="co"># avoid</span></span>
<span id="cb2-4"><a href="appendix-code-guide.html#cb2-4" tabindex="-1"></a><span class="cf">else</span> <span class="cf">if</span>(density<span class="sc">==</span><span class="dv">2</span>){pi.fun.name <span class="ot">&lt;-</span> <span class="st">&#39;pi.hnorm&#39;</span>; logphi <span class="ot">&lt;-</span> <span class="fl">6.6</span>}  <span class="co"># attracted</span></span>
<span id="cb2-5"><a href="appendix-code-guide.html#cb2-5" tabindex="-1"></a>  </span>
<span id="cb2-6"><a href="appendix-code-guide.html#cb2-6" tabindex="-1"></a>  <span class="co"># simulated positions</span></span>
<span id="cb2-7"><a href="appendix-code-guide.html#cb2-7" tabindex="-1"></a>pos <span class="ot">&lt;-</span> <span class="fu">simpop2DLT</span>(<span class="at">L=</span><span class="dv">600</span>,<span class="at">w =</span> <span class="dv">2000</span>, <span class="at">pi.x =</span> pi.fun.name,<span class="at">logphi =</span> logphi, <span class="at">En =</span> n, <span class="at">fixed.n =</span> T)</span></code></pre></div>
<p><code>sim.data</code> then uses the <code>detect2DLT</code> function to simulate the first obeserver’s detections. It uses the <code>ip0</code> inverse power detection function with <code>b=c(4.9, 0.036)</code> as this is the detection function from our real data.</p>
</div>
<div id="movement" class="section level4 hasAnchor" number="5.2.1.2">
<h4><span class="header-section-number">5.2.1.2</span> Movement<a href="appendix-code-guide.html#movement" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>For random movement, <code>sim.data</code> generates an angle from a wrapped Cauchy distribution with <span class="math inline">\(\mu = 0\)</span> and <span class="math inline">\(\rho = 0\)</span> and a distance from a lognormal distribution with <span class="math inline">\(\mu = log(12) + 1.5\)</span> and <span class="math inline">\(\sigma = 1.5\)</span> for each animal. For avoidance movement, the angle is generated from a wrapped Cauchy with <span class="math inline">\(\rho = 0.9\)</span> and <span class="math inline">\(\mu = \pi\)</span> for animals to the left of the transect and <span class="math inline">\(\mu = 0\)</span> for animals right of the transect. The distance is calculated by multiplying a random deviate from a <span class="math inline">\(Uniform(0,0.1)\)</span> distribution by the distance between the maximum distance from the transect and the animal’s distance from the transect, so that animals closest to the transect move furthest. This is scaled by 2.5 to make the mean comparable to the random case. The angle and distance moved are used to calculate each animal’s new position</p>
<p>The second observer’s detections are the simulated using the new positions. <code>sim.data</code> returns only the animals that were detected at least once.</p>
</div>
</div>
<div id="sim.mismatch" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Imperfect Matching<a href="appendix-code-guide.html#sim.mismatch" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For the mark recapture methods, if <code>mismatch = TRUE</code> then the fitting function will first apply the <code>sim.mismatch</code> function before calculating the estimates.</p>
<p>The <code>sim.mismatch</code> function starts by calculating the distance between all the animals that were seen on the first occasion and the ones seen on the second occasion. For each animal that was seen on the second occasion, it finds the closest animal seen on the first occasion. If the animals were less than 300m apart, then it records them as the same animal. If they were more than 1000m apart, it records them as different animals. It uses a inverse power function with parameter <code>b=c(6, 0.000005)</code>, to generate the probability of matching two animals between 300 and 1000m apart.</p>
<p>If two animals are recorded as the same then it combines their two entries in the dataframe into one. Likewise, if they are recorded as separate animals an entry is added to the dataframe.</p>
</div>
<div id="result" class="section level3 hasAnchor" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Getting the results<a href="appendix-code-guide.html#result" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In some scenarios, the output from <a href="simulation.html#simulation"><code>simulation(n,b,density,movement,mismatch)</code></a> is not in a nice format (contains the error message) such that it cannot be passed directly into the <code>result</code> function. We need to reformat in the following way:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="appendix-code-guide.html#cb3-1" tabindex="-1"></a><span class="co"># FOR EXAMPLE,</span></span>
<span id="cb3-2"><a href="appendix-code-guide.html#cb3-2" tabindex="-1"></a><span class="co"># sc5 &lt;- simulation(n=1200, b=99, 1, 0, FALSE)</span></span>
<span id="cb3-3"><a href="appendix-code-guide.html#cb3-3" tabindex="-1"></a>sc5[[<span class="dv">3</span>]] <span class="ot">&lt;-</span> <span class="fu">unname</span>(<span class="fu">apply</span>(sc5[[<span class="dv">3</span>]], <span class="dv">1</span>, as.list)[[<span class="dv">1</span>]])</span>
<span id="cb3-4"><a href="appendix-code-guide.html#cb3-4" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">sapply</span>(sc5[[<span class="dv">3</span>]], is.numeric))</span>
<span id="cb3-5"><a href="appendix-code-guide.html#cb3-5" tabindex="-1"></a>sc5[[<span class="dv">3</span>]] <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">t</span>(<span class="fu">sapply</span>(sc5[[<span class="dv">3</span>]][index], c)))</span>
<span id="cb3-6"><a href="appendix-code-guide.html#cb3-6" tabindex="-1"></a><span class="fu">colnames</span>(sc5[[<span class="dv">3</span>]]) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;N.hat&quot;</span>, <span class="st">&quot;lcl&quot;</span>, <span class="st">&quot;ucl&quot;</span>)</span></code></pre></div>
<p>The <code>result</code> function first removes the outliers by considering only the middle 95% of estimates. Some simulations produce unrealistically high or low estimates that in practice would be ignored. It then calculates the bias and coverage probability for each method.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="real-data.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
